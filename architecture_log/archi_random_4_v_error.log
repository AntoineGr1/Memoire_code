Traceback (most recent call last):
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\framework\ops.py", line 1619, in _create_c_op
    c_op = c_api.TF_FinishOperation(op_desc)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Negative dimension size caused by subtracting 3 from 1 for 'conv2d_3/Conv2D' (op: 'Conv2D') with input shapes: [?,1,1,256], [3,3,256,1024].

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "archi_random_4_v.py", line 38, in <module>
    keras.layers.Dense(84, activation='relu'),
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\training\tracking\base.py", line 457, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\keras\engine\sequential.py", line 116, in __init__
    self.add(layer)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\training\tracking\base.py", line 457, in _method_wrapper
    result = method(self, *args, **kwargs)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\keras\engine\sequential.py", line 203, in add
    output_tensor = layer(self.outputs[0])
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\keras\engine\base_layer.py", line 773, in __call__
    outputs = call_fn(cast_inputs, *args, **kwargs)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\keras\layers\convolutional.py", line 209, in call
    outputs = self._convolution_op(inputs, self.kernel)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\ops\nn_ops.py", line 1135, in __call__
    return self.conv_op(inp, filter)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\ops\nn_ops.py", line 640, in __call__
    return self.call(inp, filter)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\ops\nn_ops.py", line 239, in __call__
    name=self.name)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\ops\nn_ops.py", line 2011, in conv2d
    name=name)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\ops\gen_nn_ops.py", line 969, in conv2d
    data_format=data_format, dilations=dilations, name=name)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\framework\op_def_library.py", line 742, in _apply_op_helper
    attrs=attr_protos, op_def=op_def)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\framework\func_graph.py", line 595, in _create_op_internal
    compute_device)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\framework\ops.py", line 3322, in _create_op_internal
    op_def=op_def)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\framework\ops.py", line 1786, in __init__
    control_input_ops)
  File "C:\Users\antoi\anaconda3\envs\Python37\lib\site-packages\tensorflow_core\python\framework\ops.py", line 1622, in _create_c_op
    raise ValueError(str(e))
ValueError: Negative dimension size caused by subtracting 3 from 1 for 'conv2d_3/Conv2D' (op: 'Conv2D') with input shapes: [?,1,1,256], [3,3,256,1024].
